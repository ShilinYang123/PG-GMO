# 流程图制作演示案例

## 概述
本文档演示如何使用 Excalidraw MCP 服务器创建流程图，包括通过 API 接口和 Web 界面两种方式。

## 演示环境
- **服务器地址**: http://localhost:3000
- **API 接口**: RESTful API + WebSocket
- **前端界面**: Excalidraw 画布

## 演示案例：业务流程图

### 1. 通过 API 创建流程图

#### 创建的流程图包含以下元素：
1. **开始节点** - 绿色椭圆形
2. **处理节点** - 蓝色矩形
3. **决策节点** - 橙色菱形
4. **结束节点** - 红色椭圆形
5. **连接箭头** - 灰色箭头

#### API 调用示例：
```powershell
# 批量创建流程图元素
$body = '{
  "elements": [
    {
      "type": "ellipse",
      "x": 100,
      "y": 100,
      "width": 120,
      "height": 60,
      "backgroundColor": "#c8e6c9",
      "strokeColor": "#4caf50",
      "strokeWidth": 2
    },
    {
      "type": "text",
      "x": 160,
      "y": 130,
      "text": "开始",
      "fontSize": 16,
      "strokeColor": "#333333"
    },
    {
      "type": "rectangle",
      "x": 100,
      "y": 200,
      "width": 120,
      "height": 60,
      "backgroundColor": "#e3f2fd",
      "strokeColor": "#2196f3",
      "strokeWidth": 2
    },
    {
      "type": "text",
      "x": 160,
      "y": 230,
      "text": "处理数据",
      "fontSize": 14,
      "strokeColor": "#333333"
    },
    {
      "type": "diamond",
      "x": 100,
      "y": 300,
      "width": 120,
      "height": 80,
      "backgroundColor": "#fff3e0",
      "strokeColor": "#ff9800",
      "strokeWidth": 2
    },
    {
      "type": "text",
      "x": 160,
      "y": 340,
      "text": "数据有效?",
      "fontSize": 14,
      "strokeColor": "#333333"
    },
    {
      "type": "ellipse",
      "x": 100,
      "y": 420,
      "width": 120,
      "height": 60,
      "backgroundColor": "#ffebee",
      "strokeColor": "#f44336",
      "strokeWidth": 2
    },
    {
      "type": "text",
      "x": 160,
      "y": 450,
      "text": "结束",
      "fontSize": 16,
      "strokeColor": "#333333"
    },
    {
      "type": "arrow",
      "x": 160,
      "y": 160,
      "width": 0,
      "height": 40,
      "strokeColor": "#666666",
      "strokeWidth": 2
    },
    {
      "type": "arrow",
      "x": 160,
      "y": 260,
      "width": 0,
      "height": 40,
      "strokeColor": "#666666",
      "strokeWidth": 2
    },
    {
      "type": "arrow",
      "x": 160,
      "y": 380,
      "width": 0,
      "height": 40,
      "strokeColor": "#666666",
      "strokeWidth": 2
    }
  ]
}'

Invoke-RestMethod -Uri 'http://localhost:3000/api/elements/batch' -Method POST -Body $body -ContentType 'application/json'
```

#### 执行结果：
- ✅ 成功创建了 11 个流程图元素
- ✅ 包含形状、文本和连接线
- ✅ 实时同步到 WebSocket 客户端

### 2. 验证创建结果

```powershell
# 获取所有元素
Invoke-RestMethod -Uri 'http://localhost:3000/api/elements' -Method GET
```

**返回结果**：
- `success: true` - 操作成功
- `elements: [...]` - 包含所有创建的元素
- 每个元素都有唯一的 ID 和完整的属性

### 3. Web 界面访问

访问 http://localhost:3000 可以：
- 查看通过 API 创建的流程图
- 使用可视化界面编辑流程图
- 实时协作编辑
- 导出为多种格式

## 可用的 API 接口

### 元素管理
- `GET /api/elements` - 获取所有元素
- `POST /api/elements` - 创建单个元素
- `POST /api/elements/batch` - 批量创建元素
- `PUT /api/elements/:id` - 更新元素
- `DELETE /api/elements/:id` - 删除元素
- `GET /api/elements/:id` - 获取单个元素
- `GET /api/elements/search` - 搜索元素

### 同步功能
- `POST /api/elements/sync` - 同步元素
- `GET /api/sync/status` - 获取同步状态

### 健康检查
- `GET /health` - 服务器健康状态

## 支持的元素类型

- `rectangle` - 矩形
- `ellipse` - 椭圆
- `diamond` - 菱形
- `arrow` - 箭头
- `line` - 直线
- `text` - 文本
- `image` - 图片
- `freedraw` - 自由绘制

## 元素属性

### 基本属性
- `x, y` - 位置坐标
- `width, height` - 尺寸
- `backgroundColor` - 背景色
- `strokeColor` - 边框色
- `strokeWidth` - 边框宽度
- `opacity` - 透明度
- `roughness` - 粗糙度

### 文本属性
- `text` - 文本内容
- `fontSize` - 字体大小
- `fontFamily` - 字体族

## 最佳实践

1. **颜色规范**：
   - 开始/结束：绿色/红色椭圆
   - 处理步骤：蓝色矩形
   - 决策点：橙色菱形
   - 连接线：灰色箭头

2. **布局建议**：
   - 垂直间距：100px
   - 水平对齐：统一 x 坐标
   - 元素尺寸：120x60 (矩形/椭圆)

3. **API 使用**：
   - 批量创建提高效率
   - 使用 WebSocket 实现实时同步
   - 定期检查服务器健康状态

## 演示总结

✅ **成功演示了**：
- Excalidraw MCP 服务器的启动和配置
- 通过 RESTful API 创建复杂流程图
- 批量元素创建和管理
- Web 界面的可视化编辑功能
- 实时同步和协作功能

✅ **验证了功能**：
- API 接口完全可用
- 元素创建和管理正常
- WebSocket 实时通信正常
- 前端界面访问正常

这个演示展示了 Excalidraw MCP 工具的强大功能，既支持程序化创建流程图，也支持可视化交互编辑，非常适合各种流程图制作需求。