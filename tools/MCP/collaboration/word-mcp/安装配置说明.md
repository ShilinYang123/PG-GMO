# Office-Word-MCP-Server 安装配置说明

## 安装完成状态

✅ **已完成安装步骤：**
1. 从 GitHub 仓库克隆了 Office-Word-MCP-Server 源码
2. 安装了所有必需的 Python 依赖包
3. 创建了适用于 Windows 的 Claude Desktop 配置文件
4. 测试确认 MCP Server 可以正常启动

## 项目位置

- **安装目录：** `S:\PG-GMO\Office-Word-MCP-Server`
- **主程序：** `word_mcp_server.py`
- **配置文件：** `claude_desktop_config.json`

## Claude Desktop 配置

### 配置文件位置

Windows 系统中，Claude Desktop 的配置文件位于：
```
%APPDATA%\Claude\claude_desktop_config.json
```

### 配置内容

将以下配置添加到 Claude Desktop 的配置文件中：

```json
{
  "mcpServers": {
    "word-document-server": {
      "command": "C:\\Users\\YDS-workroom\\AppData\\Local\\Programs\\Python\\Python313\\python.exe",
      "args": [
        "S:\\PG-GMO\\Office-Word-MCP-Server\\word_mcp_server.py"
      ],
      "env": {
        "PYTHONPATH": "S:\\PG-GMO\\Office-Word-MCP-Server",
        "MCP_TRANSPORT": "stdio"
      }
    }
  }
}
```

### 配置步骤

1. 打开文件资源管理器
2. 在地址栏输入 `%APPDATA%\Claude`
3. 如果不存在 `claude_desktop_config.json` 文件，创建一个新文件
4. 将上述配置内容复制到文件中
5. 保存文件
6. 重启 Claude Desktop 应用程序

## 功能特性

### 文档管理
- 创建新的 Word 文档
- 提取文本和分析文档结构
- 查看文档属性和统计信息
- 列出目录中的可用文档
- 创建现有文档的副本
- 将多个文档合并为单个文档
- 将 Word 文档转换为 PDF 格式

### 内容创建
- 添加不同级别的标题
- 插入带有可选样式的段落
- 创建带有自定义数据的表格
- 添加按比例缩放的图像
- 插入分页符
- 添加脚注和尾注
- 转换脚注为尾注
- 自定义脚注和尾注样式

### 格式化功能
- 应用字体样式（粗体、斜体、下划线）
- 设置字体颜色和大小
- 创建和应用自定义样式
- 格式化表格（边框、背景色、对齐）
- 设置段落对齐和间距

### 高级功能
- 搜索和替换文本
- 提取和管理文档注释
- 按作者筛选注释
- 获取特定段落的注释
- 访问注释元数据（作者、日期、文本）

## 使用示例

配置完成后，您可以在 Claude Desktop 中执行以下操作：

- "创建一个名为 'report.docx' 的新文档，包含标题页"
- "在我的文档中添加一个标题和三个段落"
- "插入一个 4x4 的销售数据表格"
- "将第2段中的 'important' 一词格式化为粗体红色"
- "搜索并替换所有 'old term' 为 'new term'"
- "为章节标题创建自定义样式"
- "对文档中的表格应用格式"
- "提取文档中的所有注释"
- "显示 John Doe 的所有注释"
- "获取第3段的注释"
- "将表格单元格 (1,2) 中的文本设为粗体蓝色 14pt 字体"

## 测试状态

✅ **测试结果：**
- MCP Server 启动成功
- 显示服务器名称：Word Document Server
- 传输协议：STDIO
- FastMCP 版本：2.11.2
- MCP 版本：1.12.3

## 注意事项

1. 确保 Python 3.8 或更高版本已安装
2. 确保所有依赖包已正确安装
3. 配置 Claude Desktop 后需要重启应用程序
4. 如果遇到权限问题，请确保对安装目录有读写权限

## 故障排除

如果遇到问题，可以：

1. 检查 Python 路径是否正确
2. 确认所有依赖包已安装：`pip install -r requirements.txt`
3. 手动测试 MCP Server：`python word_mcp_server.py`
4. 检查 Claude Desktop 配置文件语法是否正确
5. 查看 Claude Desktop 的错误日志

---

**安装完成时间：** 2025年1月8日
**技术负责人：** 雨俊
**项目状态：** 已完成安装和配置，可以使用