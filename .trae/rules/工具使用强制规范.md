# 工具使用强制规范

## 一、总则

### 1.1 规范目的
本规范旨在确保AI Agent在执行任务时充分利用现有工具资产，提升工作效率和品质，避免重复造轮子。

### 1.2 适用范围
- 所有AI Agent执行的任务
- 所有涉及MCP服务器工具的操作
- 所有需要使用\tools下脚本的场景

### 1.3 强制性要求
**本规范为强制执行规范，AI Agent必须严格遵守，不得随意跳过或忽略。**

---

## 二、MCP服务器工具强制使用规范

### 2.1 任务管理类

#### TaskManager（任务管理器）
**强制使用场景：**
- 任何包含3个以上步骤的复杂任务
- 用户明确提出多个需求的场景
- 需要跟踪进度的长期任务

**使用要求：**
```
1. 接收任务后立即调用 request_planning 分解任务
2. 使用 get_next_task 获取下一个待执行任务
3. 完成任务后调用 mark_task_done 标记完成
4. 等待用户 approve_task_completion 批准后继续
```

#### Memory（记忆管理器）
**强制使用场景：**
- 上下文长度接近限制时
- 重要的项目信息、配置信息
- 用户偏好和历史决策
- 复杂的技术方案和架构设计

**使用要求：**
```
1. 每次会话结束前将重要信息存入Memory
2. 开始新任务时先从Memory检索相关信息
3. 项目关键决策必须记录到Memory
```

### 2.2 技术查询类

#### context7（技术文档查询）
**强制使用场景：**
- 需要查询特定技术框架文档
- 编程语言API参考
- 第三方库使用方法

**使用要求：**
```
1. 技术问题优先使用context7查询
2. 先调用 resolve-library-id 获取库ID
3. 再调用 get-library-docs 获取文档
```

### 2.3 推理分析类

#### sequential-thinking（序列化思考）
**强制使用场景：**
- 复杂问题分析
- 多步骤推理过程
- 需要验证假设的场景
- 架构设计和技术选型

**使用要求：**
```
1. 复杂推理必须使用sequential-thinking
2. 设置合理的思考步数
3. 允许修正和分支思考
```

### 2.4 办公自动化类

#### Excel MCP
**强制使用场景：**
- 所有Excel文件操作
- 数据分析和报表生成
- 表格格式化和样式设置

**禁止行为：**
- 不得手动编写Excel操作代码
- 不得使用其他Excel处理库

---

## 三、自研脚本工具强制使用规范

### 3.1 项目管理类

#### check_structure.py
**强制使用场景：**
- 项目结构验证
- 文件完整性检查
- 合规性验证

#### update_structure.py
**强制使用场景：**
- 项目结构更新
- 新增目录或文件

### 3.2 文档处理类

#### pdf_processor.py
**强制使用场景：**
- 所有PDF文件读取操作
- PDF内容提取和分析

#### office_document_reader.py
**强制使用场景：**
- Word、Excel、PPT文件读取
- Office文档内容提取

**禁止行为：**
- 不得直接使用python-docx、openpyxl等库
- 必须通过统一的文档读取器

### 3.3 数据分析类

#### 各类数据分析脚本
**强制使用场景：**
- 对应领域的数据分析任务
- 报告生成需求

---

## 四、工具选择优先级

### 4.1 优先级顺序
1. **MCP服务器工具**（最高优先级）
2. **自研脚本工具**
3. **标准Python库**
4. **第三方库**（最低优先级）

### 4.2 选择原则
- 功能覆盖：优先选择功能最全面的工具
- 集成度：优先选择与项目集成度最高的工具
- 维护性：优先选择项目内维护的工具

---

## 五、违规处理

### 5.1 违规行为
- 跳过可用的MCP服务器工具
- 重复实现已有脚本功能
- 不使用TaskManager进行任务管理
- 不使用Memory保存重要信息

### 5.2 检查机制
- start.py启动时进行工具可用性检查
- 定期审查工具使用情况
- 记录工具使用日志

---

## 六、工具使用检查清单

### 6.1 任务开始前检查
- [ ] 是否需要使用TaskManager分解任务？
- [ ] 是否需要从Memory检索相关信息？
- [ ] 是否需要使用sequential-thinking进行复杂推理？

### 6.2 执行过程中检查
- [ ] 技术查询是否使用了context7？
- [ ] Excel操作是否使用了Excel MCP？
- [ ] 文档处理是否使用了对应的处理器？

### 6.3 任务结束后检查
- [ ] 重要信息是否已存入Memory？
- [ ] 任务是否已在TaskManager中标记完成？
- [ ] 工具使用是否符合规范要求？

---

## 七、更新维护

### 7.1 规范更新
- 新增工具时及时更新规范
- 定期审查和优化使用规则
- 根据实际使用效果调整优先级

### 7.2 培训要求
- 新工具上线时进行使用培训
- 定期回顾工具使用规范
- 分享最佳实践案例

---

**制定日期：** 2025年1月25日  
**生效日期：** 立即生效  
**维护部门：** 品高线上运营室  
**版本：** v1.0